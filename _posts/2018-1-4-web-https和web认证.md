---
layout: post
title:
modified:
categories: Tech
 
tags: [web]

  
comments: true
---

<!-- TOC -->

- [ssl和https](#ssl和https)
- [来个实际的例子:](#来个实际的例子)
- [web客户端认证](#web客户端认证)

<!-- /TOC -->

### ssl和https

HTTP是基于`TCP`的超文本协议，web的本质就是http client访问http web服务器。

HTTPS即所谓的“HTTP over SSL”，实际上是将原有的 HTTP 数据 用`SSL`协议栈封装，`SSL`提供加密处理和证书机制,满足信息安全的目的。

加密也可直接用公约的加解密，但考虑到性能，采用的是`公约机制交换共享密钥`，后续双方用共享密钥对称加解密。

证书可以证明对方是可信的。服务器证书证明服务器可信，客户端证书则可完成个人身份认证。


层次大概是这样的:

![https](http://on-img.com/chart_image/5a4dad2de4b0be852dbd34a4.png)

注意，`协议封装`是个很重要的概念。和所有的`封装`一样，复杂度提高后，增加灵活性，扩展应用以满足特定需求，比低层的更容易理解等等。

https的应用安全算法的关键点是:
* 服务器证书可信
* 客户端拿到服务器证书后，可在正规CA验证服务器
* 客户端用证书公钥，与服务器交换共享密钥
* cs用共享密钥加密原http内容进行通信

HTTP的SSL建立流程:

![2018-01-08-07-59-02](https://images-1257933000.cos.ap-chengdu.myqcloud.com/2018-01-08-07-59-02.png)

流程说明:

* s1,s2双方交换ssl版本，支持的密钥算法等信息
* s3,服务端发送公钥证书到客户端
* s5, 发送pre-master secrey的rng串，用公钥加密过
* s6,客户端告知服务器后续将使用s5中的密钥加解密;
* s7,客户端将之前的所有报文，做完整性校验，由服务器校验
* s8,s9,服务器完成客户端s6,s7类似的事情，校验,
* s9客户端完成后，ssl连接建立完成



### web客户端认证

上面的https主要讲的是服务器端的认证流程,客户端当然也可以用证书，前面提到的银行u盾就属于客户端证书，对于金融适用，但互联网确实麻烦了点。

* BASIC认证

http/1.1的认证方式，就是将usr:id base64编码后发送给服务器，太简单，不安全

* DIGEST认证

有认证需求的客户端发起请求，服务器发送`挑战码`，客户端用摘要算法计算`回应码`，安全性比BASIC要高一些。 

![2018-01-08-10-41-12](https://images-1257933000.cos.ap-chengdu.myqcloud.com/2018-01-08-10-41-12.png)

* SSL客户端认证

就是`基于证书`的客户端认证。

* 基于表单的认证

通过web的服务应用，将客户端id+passwd与之前的登录信息做匹配来进行,用的比较多。

* Session管理和Cookies应用

![2018-01-18-18-52-07](https://images-1257933000.cos.ap-chengdu.myqcloud.com/2018-01-18-18-52-07.png)

